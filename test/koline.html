<!DOCTYPE html>
<!-- Note to self: don't autoformat this file using eclipse/aptana! It introduces unwanted visible spaces -->
<html lang="de" manifest="manifest.appcache">
<head>
<meta charset="utf-8" />
<title>Boules Test 1.4.9</title>
<link rel="shortcut icon" href="images/favicon.png" type="image/png" />
<style>
div {
  position: relative;
  margin: 2em;
  min-height: 1em;
  min-width: 1em;
  background-color: #d0d0d0;
  overflow: visible;
}

label {
  display: inline-block;
  width: 10em;
}
</style>
</head>

<body>
	<form>
		<label>Number of Rounds:</label><input type="number"
			disabled="disabled" id="rounds"> <br> <label>Number
			of Connectors:</label><input type="number" disabled="disabled"
			id="numconnectors"> <br> <label>Cached
			Connectors:</label><input type="number" disabled="disabled" id="cachesize">
	</form>
	<div></div>
</body>

<script id="testmain">
function TestMain(Common, $) {
  var KOLine, maxround;

  KOLine = Common('ui/koline');

  maxround = 8;

  function getX(round) {
    return 2 * (maxround - round);
  }

  function getY(round, game) {
    return 2 * (Math.pow(2, maxround - round - 1) + Math.floor(Math.pow(2,
        maxround - round)
        * game));
  }

  $(function($) {
    var $box, $svg, round, game, numconnectors;

    $box = $('div');

    round = 0;
    game = 0;
    numconnectors = 0;

    boxwidth = getX(-1);
    boxheight = getY(maxround, Math.pow(2, maxround));
    $box.css('width', boxwidth + 'em');
    $box.css('height', boxheight + 'em');

    $('#rounds').val(maxround);

    for (round = 0; round < maxround; round += 1) {
      for (game = 0; game < Math.pow(2, round); game += 1) {
        $svg = $((new KOLine(
            [getX(round + 1) + 0.5, getY(round + 1, game * 2)], [getX(round),
                getY(round, game)])).svg);
        $box.append($svg);
        $svg = $((new KOLine([getX(round + 1) + 0.5,
            getY(round + 1, game * 2 + 1)], [getX(round), getY(round, game)])).svg);
        $box.append($svg);

        numconnectors += 2;
      }
    }

    $('#cachesize').val(Object.keys(KOLine.pathCache).length);
    $('#numconnectors').val(numconnectors);
  });
}
</script>
<script data-main="scripts/testmain.js" src="scripts/require.js"></script>

</html>
